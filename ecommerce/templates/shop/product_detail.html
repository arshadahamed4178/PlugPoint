{% extends 'shop/base.html' %}

{% block title %}{{ product.name }} - Simple Shop{% endblock %}

{% block content %}
<div class="product-detail">
    <div style="display: flex; gap: 2rem;">
        <div style="flex: 1;">
            {% if product.image %}
            <img src="{{ product.image.url }}" alt="{{ product.name }}" style="max-width: 100%; border-radius: 4px;">
            {% else %}
            <div
                style="width: 100%; height: 300px; background-color: #eee; display: flex; align-items: center; justify-content: center;">
                No Image Available
            </div>
            {% endif %}
        </div>
        <div style="flex: 1;">
            <h1>{{ product.name }}</h1>

            <div class="description" style="margin: 1rem 0;">
                {{ product.description|linebreaks }}
            </div>
            
            <p class="price" style="font-size: 1.5rem; font-weight: bold;">â‚¹{{ product.price }}</p>

            <p><strong>Stock:</strong> {{ product.stock }} units available</p>

            {% if user.is_authenticated %}
            {% if product.in_stock %}
            <form action="{% url 'add_to_cart' product.id %}" method="post" style="margin-top: 1rem;">
                {% csrf_token %}
                <button type="submit"
                    style="padding: 0.5rem 1rem; background-color: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;">
                    Add to Cart
                </button>
            </form>
            {% else %}
            <button disabled
                style="padding: 0.5rem 1rem; background-color: #6c757d; color: white; border: none; border-radius: 4px;">
                Out of Stock
            </button>
            {% endif %}
            {% else %}
            <div
                style="margin-top: 1rem; padding: 1rem; background-color: #f8f9fa; border: 1px solid #ddd; border-radius: 4px;">
                <form action="{% url 'login' %}" method="get" style="display: inline;">
                    <input type="hidden" name="next" value="{{ request.path }}">
                    <button type="submit" class="btn">Login to Purchase</button>
                </form>
            </div>
            {% endif %}

            <div style="margin-top: 1rem;">
                <form action="{% url 'product_list' %}" method="get">
                    <button type="submit" class="btn">&larr; Back to Products</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}